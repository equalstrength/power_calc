<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Note on EqualStrength power analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: #27445C;
      }

      .quarto-title-block .quarto-title-banner {
        color: #27445C;
background: #FFFFF;
      }
</style>


<link rel="stylesheet" href="style.css">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Note on EqualStrength power analysis</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">September 20, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary"><span class="header-section-number">1</span> Summary</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">2</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">2.1</span> Limitations</a></li>
  </ul></li>
  <li><a href="#main-parameters" id="toc-main-parameters" class="nav-link" data-scroll-target="#main-parameters"><span class="header-section-number">3</span> Main parameters</a></li>
  <li><a href="#specific-parameters" id="toc-specific-parameters" class="nav-link" data-scroll-target="#specific-parameters"><span class="header-section-number">4</span> Specific parameters</a></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation"><span class="header-section-number">5</span> Simulation</a></li>
  <li><a href="#hungary-czechia-and-national-sub-groups" id="toc-hungary-czechia-and-national-sub-groups" class="nav-link" data-scroll-target="#hungary-czechia-and-national-sub-groups"><span class="header-section-number">6</span> Hungary, Czechia and national sub-groups</a></li>
  <li><a href="#custom-analysis" id="toc-custom-analysis" class="nav-link" data-scroll-target="#custom-analysis"><span class="header-section-number">7</span> Custom analysis</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">8</span> References</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># data manipulation</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co"># tidy output table</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr) <span class="co"># replace for loop</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(furrr) <span class="co"># increase purrr's performance using multicore processing</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Parameters #############################################################</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>in_alpha <span class="ot">&lt;-</span> <span class="fl">0.005</span>  <span class="co"># Threshold for significance level (Type I error prob.)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>in_sample <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5000</span>, <span class="dv">16000</span>, <span class="dv">100</span>) <span class="co">#Sample sizes with min, max and increment</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>in_cb_maj <span class="ot">&lt;-</span> <span class="fl">0.4</span> <span class="co"># Callback rate for majority group</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect size (ES) for main treatment using Cohen's h formula</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>in_es_main <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.15</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Second treatment effect size (half of the main effect)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>in_es_sec <span class="ot">&lt;-</span> in_es_main</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaction effect size (1/3 of the main effect)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>in_es_interact <span class="ot">&lt;-</span> in_es_main<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>in_ngroups <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># total number of ethnic groups in the main treatment</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>in_ncountries  <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="co"># number of countries in the sample of the interaction effect</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>in_reps <span class="ot">&lt;-</span> <span class="dv">150</span> <span class="co"># number of repetitions for each sample size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimation ##################################################################</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for simulation ===============================================</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="cf">function</span>(n, base_cb, ngroups, treat1, treat2, interact){</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a) Create the two variables, and assign treatment distribution (probabilities) in last part</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">minority =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'maj'</span>, <span class="fu">paste0</span>(<span class="st">'min'</span>, <span class="dv">1</span><span class="sc">:</span>(ngroups<span class="dv">-1</span>))), n, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>ngroups, ngroups))),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_treat =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># b) Create the outcome  based on probabilities</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>p <span class="ot">&lt;-</span> base_cb <span class="sc">+</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    (treat1 <span class="sc">*</span> (dat<span class="sc">$</span>minority <span class="sc">!=</span> <span class="st">'maj'</span>)) <span class="sc">+</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    (treat2 <span class="sc">*</span> dat<span class="sc">$</span>second_treat) <span class="sc">+</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    (interact <span class="sc">*</span> (dat<span class="sc">$</span>minority <span class="sc">!=</span> <span class="st">'maj'</span>) <span class="sc">*</span> dat<span class="sc">$</span>second_treat)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># c) To determine outcome: first create a random number between 0 and 1,</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># then, if that number is above "p", we assign a callback ("1")</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>random <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(dat), <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  dat<span class="sc">$</span>outcome <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>random <span class="sc">&lt;</span> dat<span class="sc">$</span>p, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># d) Estimate regression model, tidy it, save output with sample size.</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome <span class="sc">~</span> minority <span class="sc">*</span> second_treat,  <span class="at">data =</span> dat)  </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  m1_out <span class="ot">&lt;-</span> <span class="fu">tidy</span>(m1) </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  m1_out<span class="sc">$</span>n <span class="ot">&lt;-</span> n</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(m1_out)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating data frame with simulated data ===================================</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>tb_params <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand.grid</span>(</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> in_sample,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">base_cb =</span> in_cb_maj,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">ngroups =</span> in_ngroups,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">treat1 =</span> in_es_main,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">treat2 =</span> in_es_sec,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">interact =</span> in_es_interact)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>tb_duplicated <span class="ot">&lt;-</span> <span class="fu">replicate</span>(in_reps, tb_params, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>tb_final <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, tb_duplicated)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply function to simulated data =======================================</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co"># replicate results</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">5</span>)  <span class="co"># number of cpu cores for parallel process.</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>tb_result <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_pmap_dfr</span>(tb_final, sim_data, <span class="at">.progress =</span> <span class="cn">TRUE</span>, </span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>                <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">packages =</span> <span class="st">"broom"</span>, <span class="at">seed =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Results ###################################################################</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define significance ===================================================</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>tb_result<span class="sc">$</span>significant <span class="ot">&lt;-</span> <span class="fu">if_else</span>(tb_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> in_alpha, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Group and summarise the results =======================================</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>tb_summary <span class="ot">&lt;-</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  tb_result  <span class="sc">|&gt;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">':'</span>)) <span class="sc">|&gt;</span> <span class="co"># only interaction terms</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(n)  <span class="sc">|&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">power =</span> <span class="fu">mean</span>(significant), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Recording  key numbers for reporting  =================================</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>sample_result <span class="ot">&lt;-</span> </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  tb_summary <span class="sc">|&gt;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(power <span class="sc">&gt;</span> <span class="fl">0.8</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">pooled =</span> <span class="fu">min</span>(n),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">country =</span> <span class="fu">round</span>(<span class="fu">min</span>(n)<span class="sc">/</span>in_ncountries))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="summary" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Summary</h1>
<p>We estimated power as a function of a given i) sample size, ii) significance level, and iii) effect size for a pooled sample of all participating countries. For the individual simulated sample sizes, we used a sequence of different sizes varying from <strong>5,000</strong> to <strong>16,000</strong>. The significance level was determined as <strong>0.005</strong> following recent recommendations for claims of discovery of new effects <span class="citation" data-cites="benjamin_redefine_2017">[<a href="#ref-benjamin_redefine_2017" role="doc-biblioref">1</a>]</span>. We assumed a baseline callback rate of <strong>0.4</strong> and a conservative treatment effect size of <strong>-0.15</strong> based on previous studies <span class="citation" data-cites="zschirnt_ethnic_2016 larsen_pakistani_2021 lippens_state_2023">[<a href="#ref-zschirnt_ethnic_2016" role="doc-biblioref">2</a>–<a href="#ref-lippens_state_2023" role="doc-biblioref">4</a>]</span></p>
<p>Apart from these generic parameters, we also incorporated specific features from the EqualStrength research design. First we included a second treatment postulated to have the same size of the effect of the main treatment (<strong>-0.15</strong>). Finally, we also incorporated to the model an interaction term between the two treatments with an effect size assigned as half of the effect size of the main treatment (<strong>0.075</strong>).</p>
<p>The estimated sample size results from linear models <span class="citation" data-cites="gomila_logistic_2021">[<a href="#ref-gomila_logistic_2021" role="doc-biblioref">5</a>]</span> of simulated datasets using different combinations of parameters present in the EqualStrength research design. Following this method, we estimate a minimum sample size of <strong>10,200</strong> observations for each domain in each of the <strong>7</strong> countries participating in the pooled sample. This sample size is sufficient to get a power equal or greater than 80% if we observe an effect size of the interaction term equal or greater than <strong>0.075</strong>.</p>
</section>
<section id="introduction" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Introduction</h1>
<p>In this note, we describe the analysis used to estimate the statistical power for EqualStrength tests across different sample sizes. Power is defined here as the probability of rejecting the null hypothesis when it is, in fact, false. In other words, in the context of the EqualStrength project, we are using different parameters to estimate the probability of correctly accepting the hypothesis of discrimination when there is in fact discrimination. This analysis is fully reproducible and the code is available at <a href="https://github.com/equalstrength/power_calc">https://github.com/equalstrength/power_calc</a></p>
<section id="limitations" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="limitations"><span class="header-section-number">2.1</span> Limitations</h2>
<p>As with any power analysis, the scope of this analysis is limited to the statistical significance of the test only. Apart from the general limitations of the NHST approach <span class="citation" data-cites="mcshane_abandon_2019">[<a href="#ref-mcshane_abandon_2019" role="doc-biblioref">6</a>]</span>, this analysis ignores the probability of the estimate being in the wrong direction or exaggerated <span class="citation" data-cites="gelman_beyond_2014">[<a href="#ref-gelman_beyond_2014" role="doc-biblioref">7</a>]</span>.</p>
</section>
</section>
<section id="main-parameters" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Main parameters</h1>
<p>We estimate power as a function of a given i) sample size, ii) significance level, and iii) effect size in the context of each participating country.</p>
<p>For the sample size, we use a sequence of different sizes varying from 5000 to 1.6^{4}. The significance level was determined following recent recommendations for claims of discovery of new effects <span class="citation" data-cites="benjamin_redefine_2017">[<a href="#ref-benjamin_redefine_2017" role="doc-biblioref">1</a>]</span>:</p>
<ul>
<li><strong>Alpha</strong>: 0.005.</li>
</ul>
<p>The effect size can be specified either from previous studies or by assuming a “minimum effect that would be substantively important” <span class="citation" data-cites="gelman_beyond_2014">[<a href="#ref-gelman_beyond_2014" role="doc-biblioref">7</a>]</span> or interesting <span class="citation" data-cites="lakens_sample_2022">[<a href="#ref-lakens_sample_2022" role="doc-biblioref">8</a>]</span>. An overview of recent studies indicate a substantial variation of effect sizes depending on the setting and country<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Several studies also highlight that any postulation of effect sizes based on previous studies is severely limited by publication bias, population effect size heterogeneity, and model error <span class="citation" data-cites="anderson_sample-size_2017">[<a href="#ref-anderson_sample-size_2017" role="doc-biblioref">10</a>]</span>, which can lead to “overly optimistic” expectations <span class="citation" data-cites="lakens_sample_2022">[<a href="#ref-lakens_sample_2022" role="doc-biblioref">8</a>]</span>. Here we posit the following baseline callback rate and effect size for the main treatment:</p>
<ul>
<li><p><strong>Majority group call-back rate</strong>: 0.4</p></li>
<li><p><strong>Effect size of the main treatment</strong>: -0.15.</p></li>
</ul>
</section>
<section id="specific-parameters" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Specific parameters</h1>
<p>In addition to the previous parameters which are commonly found in similar power analyses, we incorporate specific features from the EqualStrength research design. First we included a second treatment and an interaction term between the two treatments.</p>
<p>The effect size of the second treatment is postulated to be half the same size of the main treatment (<strong>-0.15</strong>). Furthermore, the interaction effect size is assigned as half of the effect size of the main treatment, which results in the following value:</p>
<ul>
<li><strong>Interaction effect size</strong>: 0.075.</li>
</ul>
</section>
<section id="simulation" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Simulation</h1>
<p>Using a series of simulated data, it is possible to calculate the power with additional parameters. The estimates result from linear models <span class="citation" data-cites="gomila_logistic_2021">[<a href="#ref-gomila_logistic_2021" role="doc-biblioref">5</a>]</span> of simulated datasets incorporating different combinations of parameters present in the EqualStrength research design. Here we also get estimates for main treatments using two minority groups in addition to the majority group. The power is calculated as the proportion of times across all simulations in which the interaction term p-value was higher than 0.005.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>  tb_summary <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power))<span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"#F77F00"</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Figure 1 - Power of the interaction term"</span>, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Based on "</span>, <span class="fu">format</span>(<span class="fu">nrow</span>(tb_result), <span class="at">big.mark=</span><span class="st">","</span>), <span class="st">" simulations"</span>))<span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Following this method, we estimate a minimum pooled sample size of <strong>10,200</strong>, which means <strong>1,457</strong> observations for each domain in each of the <strong>7</strong> countries. This sample size is sufficient to get a power equal or greater than 80% if we observe an effect size of the interaction term equal or greater than <strong>0.075</strong>.</p>
</section>
<section id="hungary-czechia-and-national-sub-groups" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Hungary, Czechia and national sub-groups</h1>
<p>The pooled sample detailed in the previous sections does not include the data that will be collected in two countries (Hungary and Czechia) considering cross-comparability issues for the ethnic minority groups. Therefore, a different power analysis was conducted for these two countries. In this separate analysis, the interaction term is not included in the simulations. Therefore, the power is calculated as the proportion of times in which both effects are statistically significant.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>in_sample_country <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">200</span>, <span class="dv">1500</span>, <span class="dv">50</span>) <span class="co">#Sample sizes with min, max and increment</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function for simulation ===============================================</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    sim_data_country <span class="ot">&lt;-</span> <span class="cf">function</span>(n, base_cb, ngroups, treat1, treat2){</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># a) Create the two variables, and assign treatment distribution (probabilities) in last part</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>      dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">minority =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'maj'</span>, <span class="fu">paste0</span>(<span class="st">'min'</span>, <span class="dv">1</span><span class="sc">:</span>(ngroups<span class="dv">-1</span>))), n, </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span>ngroups, ngroups))),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">second_treat =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># b) Create the outcome based on probabilities</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>      dat<span class="sc">$</span>p <span class="ot">&lt;-</span> base_cb <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        (treat1 <span class="sc">*</span> (dat<span class="sc">$</span>minority <span class="sc">!=</span> <span class="st">'maj'</span>)) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        (treat2 <span class="sc">*</span> dat<span class="sc">$</span>second_treat)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>      <span class="co"># c) To determine outcome: first create a random number between 0 and 1,</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># then, if that number is above "p", we assign a callback ("1")</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>      dat<span class="sc">$</span>random <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(dat), <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>      dat<span class="sc">$</span>outcome <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>random <span class="sc">&lt;</span> dat<span class="sc">$</span>p, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>      <span class="co"># d) Estimate regression model, tidy it, save output with sample size.</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>      m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(outcome <span class="sc">~</span> minority <span class="sc">+</span> second_treat, <span class="at">data =</span> dat)  </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>      m1_out <span class="ot">&lt;-</span> <span class="fu">tidy</span>(m1) </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>      m1_out<span class="sc">$</span>n <span class="ot">&lt;-</span> n      </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(m1_out)</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define the parameters data frame</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    tb_params_country <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expand.grid</span>(</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">n =</span> in_sample_country,</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">base_cb =</span> in_cb_maj,</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">ngroups =</span> in_ngroups,</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat1 =</span> in_es_main,</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">treat2 =</span> in_es_sec)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Duplicate the parameters data frame</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    tb_duplicated_country <span class="ot">&lt;-</span> <span class="fu">replicate</span>(in_reps, tb_params_country, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>    tb_final_country <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, tb_duplicated_country)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Apply function to simulated data</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co"># replicate results</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plan</span>(multisession, <span class="at">workers =</span> <span class="dv">5</span>)  <span class="co"># number of cpu cores for parallel process.</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>    tb_result_country <span class="ot">&lt;-</span> furrr<span class="sc">::</span><span class="fu">future_pmap_dfr</span>(tb_final_country, sim_data_country, <span class="at">.progress =</span> <span class="cn">TRUE</span>, </span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>                    <span class="at">.options =</span> <span class="fu">furrr_options</span>(<span class="at">packages =</span> <span class="st">"broom"</span>, <span class="at">seed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define significance</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    tb_result_country<span class="sc">$</span>significant <span class="ot">&lt;-</span> <span class="fu">if_else</span>(tb_result_country<span class="sc">$</span>p.value <span class="sc">&lt;</span> in_alpha, <span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The parameters are the same as the ones described previously except for the range of sample sizes simulated that varied from 200 to 1500.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sample_country <span class="ot">&lt;-</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a> tb_result_country <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(term, n)  <span class="sc">|&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">power =</span> <span class="fu">mean</span>(significant), <span class="at">.groups =</span> <span class="st">"drop"</span>,  <span class="at">total =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">pwr80 =</span> <span class="fu">if_else</span>(power <span class="sc">&gt;</span> <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(n) <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(pwr80)) <span class="sc">|&gt;</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(mean <span class="sc">==</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As a result, the minimum sample size for which both treatment effects have a power equal or greater than 80% is equal to <strong>650</strong>. As this calculation considers two minority groups, this also means that if a country from the pooled sample wishes to compare a subgroup within the two minority groups, this subgroup should have at least <strong>217</strong> observations.</p>
</section>
<section id="custom-analysis" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Custom analysis</h1>
<p>These calculations can be reproduced or replicated with different parameters using <a href="https://danielucd.shinyapps.io/PowerCalc/">this website</a> for the pooled sample or <a href="https://danielucd.shinyapps.io/country_sample/">this website</a> for the individual country sample.</p>
<p>The code to reproduce the analyses detailed in this note is available in <a href="https://github.com/equalstrength/power_calc">this repository</a>.</p>
</section>
<section id="references" class="level1 unnumbered" data-number="8">


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">8 References</h2><div id="refs" class="references csl-bib-body" role="list">
<div id="ref-benjamin_redefine_2017" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Benjamin DJ, Berger JO, Johannesson M, Nosek BA, Wagenmakers E-J, Berk R, et al. Redefine statistical significance. Nature Human Behaviour [Internet]. 2017 Sep [cited 2023 Sep 7];2(1):6–10. Available from: <a href="https://www.nature.com/articles/s41562-017-0189-z">https://www.nature.com/articles/s41562-017-0189-z</a></div>
</div>
<div id="ref-zschirnt_ethnic_2016" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Zschirnt E, Ruedin D. Ethnic discrimination in hiring decisions: A meta-analysis of correspondence tests 1990–2015. Journal of Ethnic and Migration Studies [Internet]. 2016 May [cited 2023 Sep 20];42(7):1115–34. Available from: <a href="http://www.tandfonline.com/doi/full/10.1080/1369183X.2015.1133279">http://www.tandfonline.com/doi/full/10.1080/1369183X.2015.1133279</a></div>
</div>
<div id="ref-larsen_pakistani_2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Larsen EN, Di Stasio V. Pakistani in the <span>UK</span> and <span>Norway</span>: Different contexts, similar disadvantage. <span>Results</span> from a comparative field experiment on hiring discrimination. Journal of Ethnic and Migration Studies [Internet]. 2021 Apr [cited 2023 Jul 10];47(6):1201–21. Available from: <a href="https://doi.org/10.1080/1369183X.2019.1622777">https://doi.org/10.1080/1369183X.2019.1622777</a></div>
</div>
<div id="ref-lippens_state_2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Lippens L, Vermeiren S, Baert S. The state of hiring discrimination: <span>A</span> meta-analysis of (almost) all recent correspondence experiments. European Economic Review [Internet]. 2023 Jan [cited 2023 Sep 20];151:104315. Available from: <a href="https://linkinghub.elsevier.com/retrieve/pii/S0014292122001957">https://linkinghub.elsevier.com/retrieve/pii/S0014292122001957</a></div>
</div>
<div id="ref-gomila_logistic_2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Gomila R. Logistic or linear? <span>Estimating</span> causal effects of experimental treatments on binary outcomes using regression analysis. Journal of Experimental Psychology: General [Internet]. 2021 Apr [cited 2023 Jul 4];150(4):700–9. Available from: <a href="http://doi.apa.org/getdoi.cfm?doi=10.1037/xge0000920">http://doi.apa.org/getdoi.cfm?doi=10.1037/xge0000920</a></div>
</div>
<div id="ref-mcshane_abandon_2019" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">McShane BB, Gal D, Gelman A, Robert C, Tackett JL. Abandon <span>Statistical</span> <span>Significance</span>. The American Statistician [Internet]. 2019 Mar [cited 2023 Jul 4];73(sup1):235–45. Available from: <a href="https://doi.org/10.1080/00031305.2018.1527253">https://doi.org/10.1080/00031305.2018.1527253</a></div>
</div>
<div id="ref-gelman_beyond_2014" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Gelman A, Carlin J. Beyond <span>Power</span> <span>Calculations</span>: <span>Assessing</span> <span>Type</span> <span>S</span> (<span>Sign</span>) and <span>Type</span> <span>M</span> (<span>Magnitude</span>) <span>Errors</span>. Perspectives on Psychological Science [Internet]. 2014 Nov [cited 2023 Jul 4];9(6):641–51. Available from: <a href="https://doi.org/10.1177/1745691614551642">https://doi.org/10.1177/1745691614551642</a></div>
</div>
<div id="ref-lakens_sample_2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Lakens D. Sample <span>Size</span> <span>Justification</span>. Collabra: Psychology [Internet]. 2022 Mar [cited 2023 Jul 10];8(1):33267. Available from: <a href="https://doi.org/10.1525/collabra.33267">https://doi.org/10.1525/collabra.33267</a></div>
</div>
<div id="ref-ramos_labour_2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Ramos M, Thijssen L, Coenders M. Labour market discrimination against <span>Moroccan</span> minorities in the <span>Netherlands</span> and <span>Spain</span>: A cross-national and cross-regional comparison. Journal of Ethnic and Migration Studies [Internet]. 2021 Apr [cited 2023 Jul 10];47(6):1261–84. Available from: <a href="https://doi.org/10.1080/1369183X.2019.1622824">https://doi.org/10.1080/1369183X.2019.1622824</a></div>
</div>
<div id="ref-anderson_sample-size_2017" class="csl-entry" role="listitem">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Anderson SF, Kelley K, Maxwell SE. Sample-<span>Size</span> <span>Planning</span> for <span>More</span> <span>Accurate</span> <span>Statistical</span> <span>Power</span>: <span>A</span> <span>Method</span> <span>Adjusting</span> <span>Sample</span> <span>Effect</span> <span>Sizes</span> for <span>Publication</span> <span>Bias</span> and <span>Uncertainty</span>. Psychological Science [Internet]. 2017 Nov [cited 2023 Jul 5];28(11):1547–62. Available from: <a href="http://journals.sagepub.com/doi/10.1177/0956797617723724">http://journals.sagepub.com/doi/10.1177/0956797617723724</a></div>
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>After reviewing <a href="https://docs.google.com/document/d/11qWamqVtMofvPXyoIFzMHennLJznyNCW/edit?usp=sharing&amp;ouid=116090494512376532643&amp;rtpof=true&amp;sd=true">several previous studies</a>, we have found baseline callback rates ranging from 60-20%, call-bake rate differences from -31% (-0.31) to +7.3 (0.073). Ethnicity differences in some GEMM papers <span class="citation" data-cites="ramos_labour_2021 larsen_pakistani_2021">[<a href="#ref-larsen_pakistani_2021" role="doc-biblioref">3</a>,<a href="#ref-ramos_labour_2021" role="doc-biblioref">9</a>]</span> run from -17 to -6, and gender from +7 to +4.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>